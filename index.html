<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- CRITICAL: Direct fix for D3 "Cannot access 'D' before initialization" error -->
    <script src="/vendor-charts-patch.js"></script>
    
    <!-- CRITICAL: Load vendor bundle hook patch before anything else -->
    <script src="/react-hook-fix.js"></script>
    
    <!-- CRITICAL: Special fix for D3/charts bundle initialization -->
    <script src="/charts-bundle-fix.js"></script>
    
    <!-- Pre-patch the exact vendor causing issues -->
    <script>
      // Direct Fix for vendor-J2TkRXmV.js 
      // This intercepts script loading to patch React hooks before execution
      (function() {
        console.log('[DEBUGGER] Starting script intercept patching');
        
        // Store tracked script elements for debugging
        window.__TRACKED_SCRIPTS__ = [];
        
        // Fix for the vendor-charts issue - we need to avoid running code before initialization
        window.__SAFE_BUNDLE_PATCH__ = function(bundleName) {
          console.log('[DEBUGGER] Using safe patching for bundle:', bundleName);
          // For charts bundles, we'll create a minimal patcher that won't reference variables before init
          if (bundleName && bundleName.includes('charts')) {
            console.log('[DEBUGGER] Special handling for charts bundle');
            return function(React) {
              // Only patch if it's actually React and only if hook is missing
              if (React && typeof React === 'object' && React.createElement && !React.useLayoutEffect) {
                console.log('[DEBUGGER] Safe patching of useLayoutEffect in charts bundle');
                React.useLayoutEffect = React.useEffect || function() {};
              }
              return React;
            };
          }
          
          // For other bundles, use the standard patching approach
          return window.__PATCH_REACT_HOOKS__ || function(r) { return r; };
        };
        
        // Store original document.createElement to intercept script creation
        const originalCreateElement = document.createElement;
        
        document.createElement = function(tagName) {
          const element = originalCreateElement.call(document, tagName);
          
          // Only intercept script elements
          if (tagName.toLowerCase() === 'script') {
            console.log('[DEBUGGER] Script element created');
            
            // Store the original setAttribute method
            const originalSetAttribute = element.setAttribute;
            
            // Override setAttribute to catch changes to src
            element.setAttribute = function(name, value) {
              // Check if this is setting the src attribute to our problem file
              if (name === 'src' && value) {
                // Keep track of scripts for debugging
                window.__TRACKED_SCRIPTS__.push({
                  element: element, 
                  src: value,
                  time: new Date().toISOString()
                });
                
                console.log('[DEBUGGER] Script src attribute set:', value);
                
                // Identify the script type for special handling
                const isVendorJs = value.includes('vendor-');
                const isVendorReactJs = value.includes('vendor-react-');
                const isVendorChartsJs = value.includes('vendor-charts-');
                const isProblematicVendor = value.includes('vendor-J2TkRXmV.js');
                
                if (isVendorJs) {
                  console.log('[DEBUGGER] Vendor bundle detected:', value);
                  
                  // We need different handling for charts bundle vs. regular bundles
                  const bundleName = 
                    isVendorChartsJs ? 'charts' : 
                    isVendorReactJs ? 'react' : 
                    isProblematicVendor ? 'problematic' : 'other';
                  
                  // Add load handler with appropriate patching strategy
                  element.addEventListener('load', function() {
                    console.log('[DEBUGGER] Bundle loaded:', value);
                    
                    try {
                      // Get the appropriate patching strategy for this bundle type
                      const patcher = window.__SAFE_BUNDLE_PATCH__(bundleName);
                      
                      // Apply patching differently depending on the bundle
                      if (window.React && !window.__PATCHED_REACT__) {
                        console.log('[DEBUGGER] Patching window.React');
                        window.React = patcher(window.React);
                        window.__PATCHED_REACT__ = true;
                      }
                      
                      // For the charts bundle, we need to be extra careful
                      if (isVendorChartsJs) {
                        console.log('[DEBUGGER] Avoiding early access to charts bundle to prevent initialization errors');
                        // Don't attempt to access bundle variables, just register React hooks in global scope
                        if (!window.React) {
                          console.log('[DEBUGGER] Creating emergency React for charts bundle');
                          window.React = {
                            createElement: function() { return {}; },
                            useLayoutEffect: function() {}
                          };
                        }
                      }
                      
                      console.log('[DEBUGGER] Bundle patching completed for', value);
                    } catch (e) {
                      console.error('[DEBUGGER] Error patching bundle:', e);
                    }
                  });
                  
                  // For problematic vendor, also track errors
                  if (isProblematicVendor) {
                    console.log('[DEBUGGER] Setting up error monitoring for problematic vendor');
                    element.addEventListener('error', function(e) {
                      console.error('[DEBUGGER] Error loading problematic vendor:', e);
                    });
                  }
                }
              }
              
              // Call the original method
              return originalSetAttribute.apply(this, arguments);
            };
          }
          
          return element;
        };
        
        console.log('[DEBUGGER] Script loading intercept installed');
      })();
    </script>
    
    <!-- CRITICAL: Fix for React hooks error in vendor bundle -->
    <script>
      // Immediate polyfill for React hooks before any script loads
      // This must execute before any React code runs
      (function() {
        // Provide global emergency hooks that won't throw errors
        window.__REACT_HOOKS__ = {
          useState: function(initialState) { return [initialState, function() {}]; },
          useEffect: function(fn) { return fn(); },
          useLayoutEffect: function(fn) { return fn(); },
          useRef: function(initialValue) { return { current: initialValue }; },
          useCallback: function(fn) { return fn; },
          useMemo: function(fn) { return fn(); },
          useContext: function(ctx) { return ctx._currentValue; },
          useReducer: function(reducer, initialState) { return [initialState, function() {}]; }
        };
        
        // Direct monkey patching on the vendor bundle
        Object.defineProperty(window, 'React', {
          configurable: true,
          get: function() { return this._react; },
          set: function(v) {
            // When React is assigned, ensure it has all hooks
            if (v && typeof v === 'object') {
              if (!v.useLayoutEffect) v.useLayoutEffect = window.__REACT_HOOKS__.useLayoutEffect;
              if (!v.useState) v.useState = window.__REACT_HOOKS__.useState;
              if (!v.useEffect) v.useEffect = window.__REACT_HOOKS__.useEffect;
              if (!v.useRef) v.useRef = window.__REACT_HOOKS__.useRef;
            }
            this._react = v;
          }
        });
        
        // Also intercept module loading to patch any React before it's used
        const originalDefineProperty = Object.defineProperty;
        Object.defineProperty = function(obj, prop, descriptor) {
          // When a React module is loaded, ensure it has hooks
          if (prop === 'useLayoutEffect' && descriptor && descriptor.get === undefined) {
            console.log('Intercepted React hook definition');
            descriptor.value = window.__REACT_HOOKS__.useLayoutEffect;
          }
          return originalDefineProperty.call(this, obj, prop, descriptor);
        };
        
        console.log('Extreme React hook polyfill applied');
      })();
    </script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NPSCW592');</script>
    <!-- End Google Tag Manager -->

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Build No-Code Trading Robots | RoboQuant Academy</title>
    <meta name="description" content="Learn to create, test and scale algorithmic trading bots without writing code. Save thousands in dev costs and launch in days." />
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VRVJC2YQ2G"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VRVJC2YQ2G');
    </script>
    
    <!-- Performance Optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://use.typekit.net" crossorigin />
    <link rel="preconnect" href="https://www.youtube.com" crossorigin />
    <link rel="preconnect" href="https://player.vimeo.com" crossorigin />
    
    <!-- Preload critical assets -->
    <link rel="preload" href="/lovable-uploads/75ec0136-6eac-4af5-a2ef-798104dbc59a.png" as="image" />
    
    <!-- Fonts with display=swap for better text rendering -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" />
    <link rel="stylesheet" href="https://use.typekit.net/wxu3rmv.css" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.roboquant.ai/" />
    <meta property="og:title" content="Build No-Code Trading Robots | RoboQuant Academy" />
    <meta property="og:description" content="Learn to create, test and scale algorithmic trading bots without writing code. Save thousands in dev costs and launch in days." />
    <meta property="og:image" content="https://www.roboquant.ai/og-image.jpg" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://www.roboquant.ai/" />
    <meta property="twitter:title" content="Build No-Code Trading Robots | RoboQuant Academy" />
    <meta property="twitter:description" content="Learn to create, test and scale algorithmic trading bots without writing code. Save thousands in dev costs and launch in days." />
    <meta property="twitter:image" content="https://www.roboquant.ai/og-image.jpg" />
    
    <!-- Schema.org markup for Course -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "RoboQuant Academy",
      "description": "Learn to create, test and scale algorithmic trading bots without writing code.",
      "provider": {
        "@type": "Organization",
        "name": "RoboQuant Academy",
        "sameAs": "https://www.roboquant.ai"
      }
    }
    </script>
    
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Do I need coding experience to take this course?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, RoboQuant Academy is specifically designed for traders with zero coding knowledge. Our no-code approach lets you build fully-automated trading bots without any programming experience."
          }
        },
        {
          "@type": "Question",
          "name": "How soon can I deploy my first trading bot?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Most students deploy their first trading bot within one week of starting the course, following our step-by-step methodology."
          }
        }
      ]
    }
    </script>
    
    <!-- Meta Pixel Code - Script part only -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1570199587006306');
    fbq('track', 'PageView');
    </script>
    
    <!-- Updated Favicon -->
    <link rel="icon" href="/lovable-uploads/c963f161-8e34-4c56-be8a-40e2625c6be0.png" type="image/png">
    <!-- Preload React hook emergency fix -->
    <script>
      // Emergency React hook patching to prevent "Cannot read properties of undefined (reading 'useLayoutEffect')" error
      window.__REACT_EMERGENCY_PATCH__ = function(React) {
        // Store the first usable React instance we encounter
        if (!window.__REACT_HOOK_SOURCE__ && React && React.useState && React.useLayoutEffect) {
          window.__REACT_HOOK_SOURCE__ = React;
          console.log('Found valid React hook source');
        }
        
        // If a React is missing hooks but we have a valid hook source, patch it
        if (window.__REACT_HOOK_SOURCE__ && React && (!React.useLayoutEffect || !React.useState)) {
          console.log('Emergency patching React hooks');
          const hookSource = window.__REACT_HOOK_SOURCE__;
          
          // List of hooks to ensure are patched
          ['useState', 'useEffect', 'useLayoutEffect', 'useRef', 'useCallback', 
           'useMemo', 'useContext', 'useReducer', 'useImperativeHandle', 'useDebugValue'].forEach(hook => {
            if (!React[hook] && hookSource[hook]) {
              React[hook] = hookSource[hook];
            }
          });
        }
        
        return React;
      };
    </script>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NPSCW592"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <!-- Meta Pixel Code - NoScript part -->
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1570199587006306&ev=PageView&noscript=1"
    /></noscript>
    
    <div id="root"></div>
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "r92nhot92s");
    </script>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
